# ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î

## üìã –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```bash
cd /path/to/inventory-app
git fetch origin
git pull origin main
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Supabase

#### 2.1. –ü—Ä–æ–≤–µ—Ä–∫–∞ `supabase/config.toml`
```bash
cat supabase/config.toml
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
- ‚úÖ `major_version = 15` (–ù–ï 17!)
- ‚úÖ `port = 54321` –¥–ª—è API
- ‚úÖ `port = 54322` –¥–ª—è PostgreSQL
- ‚úÖ `port = 54323` –¥–ª—è Studio
- ‚úÖ `api_url = "http://127.0.0.1"` –∏–ª–∏ IP —Å–µ—Ä–≤–µ—Ä–∞

#### 2.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è Supabase CLI
```bash
supabase --version
```

–ï—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
```bash
# –î–ª—è Linux
bash setup-supabase-local.sh
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π –ë–î

#### 3.1. –°–ø–∏—Å–æ–∫ –º–∏–≥—Ä–∞—Ü–∏–π
```bash
ls -la supabase/migrations/
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å 24 —Ñ–∞–π–ª–∞ –º–∏–≥—Ä–∞—Ü–∏–π**, –≤–∫–ª—é—á–∞—è:
- `20241201_create_profiles_table.sql`
- `20250805000000_create_tasks_table.sql`
- `20250807184527_create_objects_table.sql`
- `20250808000000_create_hardware_table.sql`
- `20250809000000_create_chat_messages_table.sql`
- –ò –¥—Ä—É–≥–∏–µ...

#### 3.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–∏–≥—Ä–∞—Ü–∏–π
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏–º–µ—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
for file in supabase/migrations/*.sql; do
    echo "Checking: $file"
    head -5 "$file"
done
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î

#### 4.1. –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```bash
chmod +x setup-local-supabase.sh
bash setup-local-supabase.sh
```

**–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- ‚úÖ –£–¥–∞–ª–∏—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã–π Supabase (–µ—Å–ª–∏ –µ—Å—Ç—å)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π Supabase
- ‚úÖ –°–æ–∑–¥–∞—Å—Ç `.env.local` —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- ‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏

#### 4.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ Supabase
```bash
supabase status
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
API URL: http://127.0.0.1:54321
DB URL: postgresql://postgres:postgres@127.0.0.1:54322/postgres
Studio URL: http://127.0.0.1:54323
anon key: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**‚ö†Ô∏è –í–ê–ñ–ù–û:** URL –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å `127.0.0.1` –∏–ª–∏ `localhost`, –ù–ï `*.supabase.co`!

#### 4.3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ psql
psql postgresql://postgres:postgres@127.0.0.1:54322/postgres -c "\dt"
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ç–∞–±–ª–∏—Ü—ã:
- `profiles`
- `tasks`
- `objects`
- `hardware`
- `chat_messages`
- `audit_logs`

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### 5.1. –ü—Ä–æ–≤–µ—Ä–∫–∞ `.env.local`
```bash
cat .env.local
```

**–î–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å:**
```env
VITE_SUPABASE_URL=http://127.0.0.1:54321
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
VITE_API_BASE_URL=http://127.0.0.1:54321
```

**‚ö†Ô∏è –í–ê–ñ–ù–û:** 
- URL –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ (`127.0.0.1` –∏–ª–∏ IP —Å–µ—Ä–≤–µ—Ä–∞)
- –ù–ï –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å `*.supabase.co`!

#### 5.2. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–æ—Å—Ç—É–ø –∏–∑–≤–Ω–µ (–Ω–µ —Ç–æ–ª—å–∫–æ localhost)

1. –ü–æ–ª—É—á–∏—Ç—å IP —Å–µ—Ä–≤–µ—Ä–∞:
```bash
hostname -I | awk '{print $1}'
# –∏–ª–∏
ip addr show | grep "inet " | grep -v 127.0.0.1 | awk '{print $2}' | cut -d/ -f1
```

2. –û–±–Ω–æ–≤–∏—Ç—å `.env.local`:
```bash
# –ó–∞–º–µ–Ω–∏—Ç—å 127.0.0.1 –Ω–∞ IP —Å–µ—Ä–≤–µ—Ä–∞
sed -i 's/127.0.0.1/YOUR_SERVER_IP/g' .env.local
```

3. –û–±–Ω–æ–≤–∏—Ç—å `supabase/config.toml`:
```bash
sed -i 's|http://127.0.0.1|http://YOUR_SERVER_IP|g' supabase/config.toml
```

4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Supabase:
```bash
supabase restart
```

### 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

#### 6.1. –ü—Ä–æ–≤–µ—Ä–∫–∞ `src/env.js`
```bash
cat src/env.js
```

–î–æ–ª–∂–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑:
1. `window.__ENV` (–¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ö–æ—Å—Ç–∏–Ω–≥–∞)
2. `process.env` (–¥–ª—è Node.js)
3. `import.meta.env` (–¥–ª—è Vite)

#### 6.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ `src/supabaseClient.js`
```bash
cat src/supabaseClient.js
```

–î–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ `src/env.js`.

### 7. –°–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

#### 7.1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
npm install
```

#### 7.2. –°–±–æ—Ä–∫–∞
```bash
npm run build
```

#### 7.3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–±–æ—Ä–∫–∏
```bash
ls -la dist/
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å:
- `index.html`
- `assets/` (—Å JS, CSS —Ñ–∞–π–ª–∞–º–∏)
- –î—Ä—É–≥–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã

### 8. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è production (nginx)

#### 8.1. –ü—Ä–æ–≤–µ—Ä–∫–∞ nginx
```bash
sudo nginx -t
sudo systemctl status nginx
```

#### 8.2. –°–æ–∑–¥–∞–Ω–∏–µ `.env` –¥–ª—è production
```bash
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ .env.local
cp .env.local .env
```

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –î–ª—è production –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å IP —Å–µ—Ä–≤–µ—Ä–∞ –∏–ª–∏ –¥–æ–º–µ–Ω, –∞ –Ω–µ `127.0.0.1`!

#### 8.3. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
```bash
chmod +x deploy-enhanced.sh
./deploy-enhanced.sh
```

### 9. –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

#### 9.1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
# Supabase
supabase status

# Nginx
sudo systemctl status nginx

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
sudo netstat -tlnp | grep -E '54321|54322|54323|80|443'
```

#### 9.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
curl http://127.0.0.1:54321/rest/v1/
curl http://127.0.0.1:54323

# –ß–µ—Ä–µ–∑ –¥–æ–º–µ–Ω (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
curl http://multiminder.duckdns.org
```

#### 9.3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
1. –û—Ç–∫—Ä–æ–π—Ç–µ `http://YOUR_SERVER_IP:54323` - Supabase Studio
2. –û—Ç–∫—Ä–æ–π—Ç–µ `http://YOUR_SERVER_IP` –∏–ª–∏ –¥–æ–º–µ–Ω - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –Ω–∞ –æ—à–∏–±–∫–∏

### 10. –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞

#### 10.1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ systemd –¥–ª—è Supabase
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ supabase.service
cat supabase.service

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
sudo cp supabase.service /etc/systemd/system/
sudo systemctl daemon-reload
sudo systemctl enable supabase.service
sudo systemctl start supabase.service
```

#### 10.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
```bash
sudo systemctl is-enabled supabase.service
sudo systemctl is-enabled nginx
```

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "Cannot find project ref"
```bash
rm -rf .supabase/
bash setup-local-supabase.sh
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Invalid db.major_version: 17"
```bash
sed -i 's/major_version = 17/major_version = 15/' supabase/config.toml
supabase restart
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è
```bash
supabase db reset
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.env.local` –∏–ª–∏ `.env`
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä –∏–ª–∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `public/env.js` (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—É—Å—Ç—ã–º –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è)

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–î –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –æ—á–∏—Å—Ç–∏—Ç—å
supabase stop
rm -rf .supabase/

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
supabase start
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Ä—Ç –∑–∞–Ω—è—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ä—Ç
sudo lsof -i :54321
sudo lsof -i :54322

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç –≤ config.toml
```

## üìù –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

- [ ] –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –æ–±–Ω–æ–≤–ª–µ–Ω –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏
- [ ] Supabase CLI —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] `supabase/config.toml` –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–≤–µ—Ä—Å–∏—è 15, –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–æ—Ä—Ç—ã)
- [ ] –í—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –º–µ—Å—Ç–µ (24 —Ñ–∞–π–ª–∞)
- [ ] –õ–æ–∫–∞–ª—å–Ω—ã–π Supabase –∑–∞–ø—É—â–µ–Ω (`supabase status`)
- [ ] `.env.local` —Å–æ–∑–¥–∞–Ω —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã (`supabase db reset`)
- [ ] –¢–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã (–ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ `psql` –∏–ª–∏ Studio)
- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–±—Ä–∞–Ω–æ (`npm run build`)
- [ ] Nginx –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ (`deploy-enhanced.sh`)
- [ ] –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ—Å—Ç—É–ø–Ω—ã (–ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ `curl`)
- [ ] –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (systemd)
- [ ] –¢–µ—Å—Ç–æ–≤–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è/–≤—Ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# 1. –û–±–Ω–æ–≤–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git pull origin main

# 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –ë–î
bash setup-local-supabase.sh

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
supabase status

# 4. –°–æ–±—Ä–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
npm install
npm run build

# 5. –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å
./deploy-enhanced.sh

# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
curl http://localhost
```

## üìû –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `LOCAL_SETUP.md`
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: `SERVER_DEPLOYMENT.md`
- Production setup: `PRODUCTION_SETUP.md`



